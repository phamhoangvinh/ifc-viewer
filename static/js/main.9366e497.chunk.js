(this["webpackJsonpweb-ifc-viewer-simple-react"]=this["webpackJsonpweb-ifc-viewer-simple-react"]||[]).push([[0],{129:function(e,t,n){"use strict";n.r(t);var i=n(2),c=n.n(i),a=n(19),o=n.n(a),r=(n(91),n(16)),s=n(7),l=n.n(s),p=n(10),d=n(0),j=n(1),u=n(3),b=n(4),h=(n(93),n(75)),O=n(167),f=n(157),x=n(168),v=n(54),w=n(40),g=n(76),m=n(68),C=n(155),k=n(163),y=n(164),D=n(166),I=n(165),B=n(162),F=n(170),S=n(158),R=n(159),V=n(169),P=n(132),_=n(160),z=n(161),E=n(12),L=["onOpenViewpoint"],N=Object(C.a)({root:{maxWidth:345},media:{height:140}});function T(e){var t=e.onOpenViewpoint,n=Object(g.a)(e,L),c=Object(i.useState)(),a=Object(w.a)(c,2),o=a[0],s=a[1],d=Object(i.useState)([]),j=Object(w.a)(d,2),u=j[0],b=j[1],h=function(n){t(n),e.onClose()},O=Object(i.useCallback)(function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new m.BcfReader,e.next=3,n.read(t[0]);case 3:b(n.topics),s(t[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),f=Object(v.b)({onDrop:O,accept:".bcf"}),x=f.getRootProps,C=f.getInputProps,k=f.isDragActive,y=u.filter((function(e){return e.viewpoints.length>0}));return Object(E.jsxs)(F.a,Object(r.a)(Object(r.a)({maxWidth:"xl",fullWidth:!0,disableBackdropClick:!0},n),{},{children:[Object(E.jsx)(S.a,{children:"BCF Viewer"}),Object(E.jsxs)(R.a,{children:[!o&&Object(E.jsxs)(V.a,Object(r.a)(Object(r.a)({height:600,display:"flex",alignItems:"center",justifyContent:"center",border:k?"solid 4px":"none",borderColor:k?"#ffa50f":"",borderRadius:20},x()),{},{children:[Object(E.jsx)("input",Object(r.a)({},C())),k?Object(E.jsx)(P.a,{variant:"h6",children:"Drop the BCF here ..."}):Object(E.jsx)(P.a,{variant:"h6",children:"Drag 'n' drop a BCF here, or click to select"})]})),o&&Object(E.jsx)(_.a,{container:!0,spacing:2,children:y.map((function(e,t){return Object(E.jsx)(_.a,{item:!0,children:Object(E.jsx)(W,{topic:e,onOpenViewpoint:h})},t)}))})]}),Object(E.jsx)(z.a,{children:Object(E.jsx)(B.a,{onClick:e.onClose,children:"Close"})})]}))}function W(e){var t,n,c=N(),a=e.topic,o=e.onOpenViewpoint,r=(null===a||void 0===a||null===(t=a.markup)||void 0===t||null===(n=t.viewpoints)||void 0===n?void 0:n.length)>0?a.markup.viewpoints[0]:null,s=Object(i.useState)(""),d=Object(w.a)(s,2),j=d[0],u=d[1];return Object(i.useEffect)((function(){(function(){var e=Object(p.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return e.next=3,a.getViewpointSnapshot(r);case 3:t=e.sent,n=window.URL.createObjectURL(t),u(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r,a]),Object(E.jsx)(k.a,{className:c.root,children:Object(E.jsxs)(y.a,{onClick:function(){a.viewpoints.length>0&&o(a.viewpoints[0])},children:[Object(E.jsx)(I.a,{className:c.media,image:j,title:a.markup.topic.title}),Object(E.jsxs)(D.a,{children:[Object(E.jsx)(P.a,{gutterBottom:!0,variant:"h5",component:"h2",children:a.markup.topic.title}),Object(E.jsx)(P.a,{variant:"body2",color:"textSecondary",component:"p",children:a.markup.topic.description})]})]})})}var U=n(73),M=n.n(U),A=n(74),J=n.n(A),G=function(e){Object(u.a)(n,e);var t=Object(b.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).state={bcfDialogOpen:!1,loaded:!1,loading_ifc:!1},i.onDrop=function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.setState({loading_ifc:!0}),e.next=3,i.viewer.IFC.loadIfc(t[0],!0);case 3:i.setState({loaded:!0,loading_ifc:!1});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.handleToggleClipping=function(){i.viewer.clipper.active=!i.viewer.clipper.active},i.handleClickOpen=function(){i.dropzoneRef.current.open()},i.handleOpenBcfDialog=function(){i.setState(Object(r.a)(Object(r.a)({},i.state),{},{bcfDialogOpen:!0}))},i.handleCloseBcfDialog=function(){i.setState(Object(r.a)(Object(r.a)({},i.state),{},{bcfDialogOpen:!1}))},i.handleOpenViewpoint=function(e){i.viewer.currentViewpoint=e},i.dropzoneRef=c.a.createRef(),i}return Object(j.a)(n,[{key:"componentDidMount",value:function(){var e=document.getElementById("viewer-container"),t=new h.a({container:e});t.addAxes(),t.addGrid(),t.IFC.setWasmPath("./wasm/"),this.viewer=t,window.onmousemove=t.prepickIfcItem,window.ondblclick=t.addClippingPlane}},{key:"render",value:function(){return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(T,{open:this.state.bcfDialogOpen,onClose:this.handleCloseBcfDialog,onOpenViewpoint:this.handleOpenViewpoint}),Object(E.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100vh"},children:[Object(E.jsxs)("aside",{style:{width:50},children:[Object(E.jsx)(O.a,{onClick:this.handleClickOpen,children:Object(E.jsx)(M.a,{})}),Object(E.jsx)(O.a,{onClick:this.handleToggleClipping,children:Object(E.jsx)(J.a,{})})]}),Object(E.jsx)(v.a,{ref:this.dropzoneRef,onDrop:this.onDrop,children:function(e){var t=e.getRootProps,n=e.getInputProps;return Object(E.jsx)("div",Object(r.a)(Object(r.a)({},t({className:"dropzone"})),{},{children:Object(E.jsx)("input",Object(r.a)({},n()))}))}}),Object(E.jsx)("div",{style:{flex:"1 1 auto",minWidth:0},children:Object(E.jsx)("div",{id:"viewer-container",style:{position:"relative",height:"100%",width:"100%"}})})]}),Object(E.jsx)(f.a,{style:{zIndex:100,display:"flex",alignItems:"center",alignContent:"center"},open:this.state.loading_ifc,children:Object(E.jsx)(x.a,{})})]})}}]),n}(c.a.Component),q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,173)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),i(e),c(e),a(e),o(e)}))};o.a.render(Object(E.jsx)(c.a.StrictMode,{children:Object(E.jsx)(G,{})}),document.getElementById("root")),q()},91:function(e,t,n){},93:function(e,t,n){},99:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=99}},[[129,1,2]]]);
//# sourceMappingURL=main.9366e497.chunk.js.map